@extends('layouts.app')

@section('content')
<form id="inference-form" action="{{ route('inference.run') }}" method="POST">
    @csrf

    <div class="grid-container">
        <aside class="sidebar">

            <!-- üîπ Ch·ªçn / Qu·∫£n l√Ω b·ªô lu·∫≠t -->
            <div class="card">
                <h2>Ch·ªçn b·ªô lu·∫≠t</h2>

                <select id="rule-set-selector" class="form-select">
                    <option value="">-- Ch∆∞a ch·ªçn b·ªô lu·∫≠t n√†o --</option>
                </select>

                <button type="button" id="new-rule-set" class="btn btn-primary mt-2">+ T·∫°o b·ªô lu·∫≠t m·ªõi</button>
                <button type="button" id="delete-rule-set" class="btn btn-danger mt-2">üóë Xo√° b·ªô lu·∫≠t</button>
            </div>

            <!-- üîπ Modal t·∫°o b·ªô lu·∫≠t -->
            <div id="new-rule-set-modal" class="modal-overlay hidden">
                <div class="modal-content">
                    <h3>T·∫°o b·ªô lu·∫≠t m·ªõi</h3>
                    <label>T√™n b·ªô lu·∫≠t:</label>
                    <input type="text" id="rule-set-name" class="form-input" placeholder="VD: Lu·∫≠t ƒë·ªông v·∫≠t">
                    <label>M√¥ t·∫£:</label>
                    <textarea id="rule-set-desc" class="form-textarea" placeholder="M√¥ t·∫£ b·ªô lu·∫≠t..."></textarea>
                    <div class="modal-actions">
                        <button id="cancel-new-set" type="button" class="btn btn-secondary">H·ªßy</button>
                        <button id="confirm-new-set" type="button" class="btn btn-primary">T·∫°o</button>
                    </div>
                </div>
            </div>

            <!-- üîπ Nh·∫≠p lu·∫≠t -->
            <div class="card">
                <h2>Nh·∫≠p lu·∫≠t</h2>
                <button type="button" id="open-bulk-form" class="btn btn-primary">+ Th√™m lu·∫≠t</button>
                <button type="button" id="import-button" class="btn btn-secondary">Import lu·∫≠t</button>

                <div id="rules-list" class="rules-facts-list"></div>
                <textarea id="rules-storage" name="rules" class="hidden"></textarea>
                <input type="file" id="file-importer" class="hidden" accept=".txt,.json,.docx">
            </div>

            <!-- üîπ Modal nh·∫≠p nhi·ªÅu lu·∫≠t -->
            <div id="bulk-form" class="modal-overlay hidden">
                <div class="modal-content">
                    <h3>Nh·∫≠p nhi·ªÅu lu·∫≠t c√πng l√∫c</h3>
                    <p>M·ªói d√≤ng l√† m·ªôt lu·∫≠t, v√≠ d·ª•:<br>
                        <code>A ^ B ‚Üí C</code><br>
                        <code>D ‚Üí E</code>
                    </p>
                    <textarea id="bulk-rules-input" class="form-textarea" placeholder="Nh·∫≠p c√°c lu·∫≠t ·ªü ƒë√¢y..."></textarea>
                    <div class="modal-actions">
                        <button id="cancel-bulk" type="button" class="btn btn-secondary">H·ªßy</button>
                        <button id="confirm-bulk" type="button" class="btn btn-primary">X√°c nh·∫≠n th√™m</button>
                    </div>
                </div>
            </div>

            <!-- üîπ Gi·∫£ thi·∫øt -->
            <div class="card">
                <h2>Nh·∫≠p gi·∫£ thi·∫øt</h2>
                <input type="text" id="fact-input" class="form-input" placeholder="VD: a,b">
                <button type="button" id="add-fact-button" class="btn btn-success">+ Th√™m gi·∫£ thi·∫øt</button>
                <div id="facts-list" class="rules-facts-list"></div>
                <input type="text" id="facts-storage" name="facts" class="hidden">
            </div>

            <!-- üîπ K·∫øt lu·∫≠n -->
            <div id="goal-input-container" class="card">
                <h2>Nh·∫≠p k·∫øt lu·∫≠n (Goal)</h2>
                <input type="text" name="goal" class="form-input" placeholder="VD: D ‚Äî m·ª•c ti√™u c·∫ßn ch·ª©ng minh ho·∫∑c ƒë·∫°t ƒë∆∞·ª£c.">
            </div>

            <!-- üîπ Lo·∫°i suy di·ªÖn -->
            <div class="card">
                <h2>Ch·ªçn lo·∫°i suy di·ªÖn</h2>
                <div class="radio-group">
                    <label>
                        <input type="radio" id="forward" name="inference_type" value="forward" class="form-radio" checked>
                        Suy di·ªÖn ti·∫øn (Forward Chaining)
                    </label>
                    <label>
                        <input type="radio" id="backward" name="inference_type" value="backward" class="form-radio">
                        Suy di·ªÖn l√πi (Backward Chaining)
                    </label>
                </div>
            </div>

            <!-- üîπ Thao t√°c -->
            <div class="card">
                <h2>N√∫t thao t√°c</h2>
                <div class="button-group">
                    <button type="submit" class="btn btn-submit">Ch·∫°y suy di·ªÖn</button>
                    <button type="reset" class="btn btn-danger">Xo√° d·ªØ li·ªáu</button>
                    <button type="button" id="save-button" class="btn btn-dark">üíæ L∆∞u d·ªØ li·ªáu (F11)</button>
                </div>
            </div>

        </aside>

        <section class="main-content">
            <!-- üîπ ƒê·ªì th·ªã -->
            <div class="card">
                <div class="card-header">
                    <h2>Khu v·ª±c ƒë·ªì th·ªã</h2>
                    <div class="radio-group horizontal">
                        <label><input type="radio" name="graph_type" value="fpg" class="form-radio" checked> FPG</label>
                        <label><input type="radio" name="graph_type" value="rpg" class="form-radio"> RPG</label>
                    </div>
                </div>
                <div id="graph-container">
                    <p class="placeholder-text">ƒê·ªì th·ªã s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
                </div>
            </div>

            <!-- üîπ K·∫øt qu·∫£ -->
            <div class="card">
                <h2>K·∫øt qu·∫£ suy di·ªÖn</h2>
                <div id="results-output">
                    <p><strong>S·ª± ki·ªán m·ªõi:</strong> <span id="result-facts" class="result-facts">...</span></p>
                    <p><strong>Lu·∫≠t ƒë∆∞·ª£c k√≠ch ho·∫°t:</strong> <span id="result-rules" class="result-rules">...</span></p>
                </div>
            </div>
        </section>
    </div>
</form>
@endsection
